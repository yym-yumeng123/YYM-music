<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>FM</title>
	<link rel="stylesheet" href="css/reset.css">
	<link rel="stylesheet" href="./css/index.css">
	<script src="//at.alicdn.com/t/font_434295_pltfyacdkppkfbt9.js"></script>
	<style>

	</style>
</head>
<body>
	<div class="pages">
		<!-- <div class="bg"></div> -->
		<img id="bg" src="images/bg.jpg" alt="">
		<div class="play clearfix">
			<!-- 左边专辑播放页 -->
			<div class="music-panel">
				<img src="images/bg.jpg" alt="专辑封面">
				<div class="pic">
					<svg class="icon iconfont">
				    	<use xlink:href="#icon-dianzan"></use>
					</svg>
					<svg class="icon iconfont">
					    <use xlink:href="#icon-zanting"></use>
					</svg>
					<svg class="icon iconfont">
					    <use xlink:href="#icon-bofang"></use>
					</svg>
					<svg class="icon iconfont">
					    <use xlink:href="#icon-ttpodicon"></use>
					</svg>
				</div>			
			</div>

			<!-- 右边歌曲信息 -->
			<div class="intro">
				<p>在路上</p>
				<h2>It's a new day</h2>
				<div class="information">
					<svg class="icon icon-num">
				    	<use xlink:href="#icon-1"></use>
					</svg>100
				</div>
				<div class="information">
					<svg class="icon icon-num">
					    <use xlink:href="#icon-dianzan"></use>
					</svg>300
				</div>
				<div class="information">
					<svg class="icon icon-num">
					    <use xlink:href="#icon-d"></use>
					</svg>LavaRadio
				</div>

				<div class="progress">
			        <div class="bar">
			          <div class="progress-total"></div>
			          <div class="progress-now"></div>
			        </div>
			        <div class="time">0:00</div>
			        <div class="info">
			        	<div class="title"></div>
			        	<div class="auther"></div>
			    	</div>
			     </div>   

			</div>
		</div>

		<ul class="clearfix">
			<li>
				<img src="images/1.jpg" alt="专题">
				<div class="name">
					
				</div>				
			</li>
			<li>
				<img src="images/2.jpg" alt="专题">
				<div class="name">					
				</div>					
			</li>
			<li>
				<img src="images/3.jpg" alt="专题">	
				<div class="name">					
				</div>				
			</li>
			<li>
				<img src="images/4.jpg" alt="专题">	
				<div class="name">					
				</div>				
			</li>
			<li>
				<img src="images/5.jpg" alt="专题">
				<div class="name">					
				</div>	
			</li>
			<li>
				<img src="images/6.jpg" alt="专题">
				<div class="name">					
				</div>	
			</li>
		</ul>
	</div>


<script>


	var Singlename = document.querySelectorAll("ul>li .name")
	//获取专辑分类
	var xhr = new XMLHttpRequest()
	xhr.open('GET',' https://jirenguapi.applinzi.com/fm/getChannels.php',true)
	xhr.onload = function(){
		if ((xhr.status>=200 && xhr.status<300) || xhr.status == 300) {
			var list = JSON.parse(xhr.responseText)
			var index = 0
			for (var i = 0; i < Singlename.length; i++) {
				Singlename[i].innerText = list.channels[index].name
				index++
			}								 
		}else{
			alert("服务器异常")
		}
	}
	xhr.send()




	//音乐地址
	//封装一个函数
	function getMusiclist(callback){

		var xhr = new XMLHttpRequest()
		xhr.open('GET','https://jirenguapi.applinzi.com/fm/getSong.php',true)
		xhr.onload = function(){
			if ((xhr.status>=200 && xhr.status<300) || xhr.status == 300) {
				callback(JSON.parse(xhr.responseText))			 
			}else{
				alert("服务器异常")
			}
		}
		xhr.send()

	}

	var currentIndex = 0
	var audioObject = new Audio()
	audioObject.autoplay = true
	var title = document.querySelector('.info .title')
	var auther = document.querySelector('.info .auther')
	var pic = document.querySelector('.music-panel img')
	var bg = document.querySelector('#bg')
	

	//调用
	getMusiclist(function(list){
		// 获取音乐播放列表第一个
		loadMusic(list.song[currentIndex])
	})
	
	function loadMusic(musicObj){
		console.log(musicObj)
		//获取资源的url,标题和作者
		audioObject.src = musicObj.url
		console.log(audioObject.src)
		title.innerText = musicObj.title
		auther.innerText = musicObj.artist
		pic.src = musicObj.picture
		bg.src = musicObj.picture
	}

	audioObject.ontimeupdate = function(){
		console.log(1)
	}
	


</script>



</body>
</html>